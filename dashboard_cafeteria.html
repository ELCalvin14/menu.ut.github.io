<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Panel Cafeter√≠a - UT Altamira</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Bootstrap 3 -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <!-- Estilos propios -->
  <link rel="stylesheet" href="styles.css">
  <!-- Nuestro script para simular el escaneo y editar alimentos -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <script src="https://unpkg.com/html5-qrcode@2.3.7/html5-qrcode.min.js"></script>
  <script src="qr_scanner.js" defer></script>
</head>
<body class="cafe-body">
  <!-- HEADER -->
  <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container-fluid header-container">
      <div class="navbar-header text-center">
        <div class="header-box center-block">
          <img src="images/logo-utalt.png" alt="UT Altamira" class="header-logo">
          <span class="header-text">Cafeter√≠a Dragones</span>
        </div>
      </div>
      <ul class="nav navbar-nav navbar-right">
        <li><a href="index.html"><span class="glyphicon glyphicon-home"></span> Inicio</a></li>
        <li><a href="login.html"><span class="glyphicon glyphicon-log-out"></span> Cerrar Sesi√≥n</a></li>
      </ul>
    </div>
  </nav>

  <!-- CONTENEDOR DE CONTENIDO -->
  <div class="content-wrapper">
    <div class="container" style="margin-top:70px;">
      <h2 class="text-center">Gesti√≥n de Cafeter√≠a</h2>
      <div class="row">
        <!-- Panel para editar informaci√≥n general (horario, men√∫ general) -->
        <div class="col-sm-6">
          <div class="panel panel-default">
            <div class="panel-heading"><strong>Editar Informaci√≥n General</strong></div>
            <div class="panel-body">
              <form id="info-form">
                <div class="form-group">
                  <label for="caf-horario">Horario</label>
                  <input type="text" id="caf-horario" class="form-control" value="7:00 AM - 5:00 PM">
                </div>
                <div class="form-group">
                  <label for="caf-menu">Men√∫ del D√≠a (Texto general)</label>
                  <textarea id="caf-menu" class="form-control" rows="4">Sandwich - $25
Baguette - $40
Jugo Natural - $20</textarea>
                </div>
                <button type="button" class="btn btn-success">Guardar Cambios</button>
              </form>
            </div>
          </div>
        </div>
        <!-- Panel para editar alimentos individuales -->
        <div class="col-sm-6">
          <div class="panel panel-default">
            <div class="panel-heading"><strong>Editar Alimentos</strong></div>
            <div class="panel-body">
              <!-- Contenedor scrollable para la tabla -->
              <div class="scrollable-table">
                <table class="table table-bordered">
                  <thead>
                    <tr>
                      <th>Nombre</th>
                      <th>Precio</th>
                      <th>Acci√≥n</th>
                    </tr>
                  </thead>
                  <tbody id="food-table-body">
                    <!-- Aqu√≠ se muestran 24 filas (simuladas) -->
                    <tr data-index="0">
                      <td>Sandwich</td>
                      <td>$25</td>
                      <td><button class="btn btn-primary btn-edit-food">Editar</button></td>
                    </tr>
                    <tr data-index="1">
                      <td>Baguette</td>
                      <td>$40</td>
                      <td><button class="btn btn-primary btn-edit-food">Editar</button></td>
                    </tr>
                    <tr data-index="2">
                      <td>Jugo Natural</td>
                      <td>$20</td>
                      <td><button class="btn btn-primary btn-edit-food">Editar</button></td>
                    </tr>
                    <tr data-index="3">
                      <td>Ensalada</td>
                      <td>$30</td>
                      <td><button class="btn btn-primary btn-edit-food">Editar</button></td>
                    </tr>
                    <tr data-index="4">
                      <td>Pizza</td>
                      <td>$50</td>
                      <td><button class="btn btn-primary btn-edit-food">Editar</button></td>
                    </tr>
                  </tbody>
                </table>
              </div> <!-- .scrollable-table -->
            </div>
          </div>
        </div>
      </div>
      
      <!-- Panel de escaneo QR (para reclamar beca) -->
      <div class="row" style="margin-top:30px;">
        <div class="col-sm-12">
          <div class="panel panel-default">
            <div class="panel-heading"><strong>Escanear QR de Beca</strong></div>
            <div class="panel-body text-center">
              <button id="btn-abrir-qr" class="btn btn-info">üì∑ Abrir C√°mara y Escanear</button>
              <div id="reader" style="width: 300px; margin: 20px auto; display: none;"></div>
              <div id="qr-result" class="well" style="display:none; margin-top:20px;"></div>
            </div>
          </div>
        </div>
      </div>
      
    </div>
  </div>

  <!-- Modal para editar alimento -->
  <div id="editFoodModal" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Editar Alimento</h4>
        </div>
        <div class="modal-body">
          <form id="edit-food-form">
            <div class="form-group">
              <label for="food-name">Nombre</label>
              <input type="text" id="food-name" class="form-control" required>
            </div>
            <div class="form-group">
              <label for="food-price">Precio</label>
              <input type="text" id="food-price" class="form-control" required>
            </div>
            <div class="form-group">
              <label for="food-description">Descripci√≥n</label>
              <textarea id="food-description" class="form-control" rows="3" required></textarea>
            </div>
            <div class="form-group">
              <label for="food-ingredients">Ingredientes</label>
              <input type="text" id="food-ingredients" class="form-control">
            </div>
            <div class="form-group">
              <label for="food-image">URL de la imagen</label>
              <input type="text" id="food-image" class="form-control">
            </div>
            <button type="submit" class="btn btn-primary">Guardar Cambios</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- FOOTER -->
  <footer class="footer">
    <div class="container text-center">
      <p>&copy; 2025 Universidad Tecnol√≥gica de Altamira ‚Äî Cafeter√≠a Dragones</p>
    </div>
  </footer>

  <!-- Scripts de Bootstrap y jQuery -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

  <script>
    /********* Gesti√≥n de alimentos **********/
    // Datos simulados para 24 alimentos
    let foodItems = [
      { name: "Sandwich", price: "$25", description: "Delicioso sandwich con queso y jam√≥n.", ingredients: "Pan, queso, jam√≥n, lechuga", image: "images/food1.jpg" },
      { name: "Baguette", price: "$40", description: "Baguette crujiente y sabrosa.", ingredients: "Pan, mantequilla, mermelada", image: "images/food2.jpg" },
      { name: "Jugo Natural", price: "$20", description: "Refrescante jugo natural.", ingredients: "Fruta fresca, hielo", image: "images/food3.jpg" },
      { name: "Ensalada", price: "$30", description: "Ensalada fresca y saludable.", ingredients: "Vegetales mixtos, aderezo", image: "images/food4.jpg" },
      { name: "Pizza", price: "$50", description: "Pizza individual con ingredientes frescos.", ingredients: "Masa, salsa, queso, vegetales", image: "images/food5.jpg" },
    ];

    // Renderiza los alimentos en la tabla
    function renderFoodTable() {
      let tbody = $("#food-table-body");
      tbody.empty();
      foodItems.forEach((item, index) => {
        tbody.append(`
          <tr data-index="${index}">
            <td>${item.name}</td>
            <td>${item.price}</td>
            <td><button class="btn btn-primary btn-edit-food">Editar</button></td>
          </tr>
        `);
      });
    }
    renderFoodTable();

    // Manejo de edici√≥n de alimentos
    $(document).on("click", ".btn-edit-food", function() {
      const row = $(this).closest("tr");
      const index = row.data("index");
      const food = foodItems[index];
      $("#food-name").val(food.name);
      $("#food-price").val(food.price);
      $("#food-description").val(food.description);
      $("#food-ingredients").val(food.ingredients);
      $("#food-image").val(food.image);
      $("#editFoodModal").data("index", index).modal("show");
    });

    $("#edit-food-form").on("submit", function(e) {
      e.preventDefault();
      const index = $("#editFoodModal").data("index");
      foodItems[index] = {
        name: $("#food-name").val(),
        price: $("#food-price").val(),
        description: $("#food-description").val(),
        ingredients: $("#food-ingredients").val(),
        image: $("#food-image").val()
      };
      renderFoodTable();
      $("#editFoodModal").modal("hide");
    });
  </script>
</body>
</html>
